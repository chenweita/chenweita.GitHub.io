---
layout: post
title: JavaScript忍者秘籍
date: 2019-11-13
categories: blog
tags: [JavaScript]

---

感觉自己对javascript中的promise的模块还是很模糊，所以今天决定来看一下另一本书的promise，看看会不会有所收获叭~

当我们从服务器获取数据时，这是一个很长时间的操作，但js依赖于单线程执行模型，所以一直到长时间的操作结束之前，UI的渲染都会暂停，随后的应用都会无响应，会让用户感到不满。这时候就出现了回调函数，每次任务结束后都调用回调函数，就不会导致UI暂停

虽然回调函数可以显著提高用户体验，但是代码会很散乱，包含很多错误处理代码，看起来很丑陋，而且链式的调用，很容易出现我们常说的回调地狱

这时候就出现了promise，它用于计算我们现在不需要但未来某时候需要的值，promise对象是对我们现在尚未得但将来会得到的值的占位符

### 回调函数的问题
1. 错误难以处理
出现错误时，无法用内置的构造函数来处理，类似与try-catch的方式，但问题在于当长时间任务开始运行，调用回调函数的代码一般不会和开始任务中的try-catch代码位于事件循环的同一步骤，导致错误经常丢失，因此很多函数库定义了各自的报错错误规约，比如node.js一般具有两个参数err和data，但错误发生时却难以处理
2. 
为了解决这个问题，我们可能就会写一丢嵌套的回调函数用来表明一系列步骤，增加错误处理也会大大增加代码的复杂度，代码会越来越难以管理，这就是第二个问题，执行连续步骤
3. 使行动之间不互相依赖，当获取所有信息后，就能立刻执行计划，不得不书写很多代码仅仅用于并行执行多个行动，导致了回调函数的第三个问题：执行很多任务也很棘手
